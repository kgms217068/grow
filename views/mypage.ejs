<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>마이페이지</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      background: #F9F9F9;
      display: flex;
      justify-content: center;
    }

    .main-wrapper {
      position: relative;
      width: 402px;
      height: 874px;
      background-color: #ffffff;
      overflow: hidden;
    }

    .container {
      padding: 20px;
      padding-bottom: 90px;
    }

    /* 🏅 프로필 + 휘장 */
    .profile-section {
      display: flex;
      align-items: center;
      margin-top: 20px;
    }

    .profile-wrapper {
      position: relative;
      width: 100px;
      height: 100px;
    }

    .profile-img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      overflow: hidden;
      z-index: 1;
    }

    .profile-img svg {
      width: 100px;
      height: 100px;
      display: block;
    }

    .badge-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100px;
      z-index: 2;
      pointer-events: none;
    }

    .nickname-box {
      margin-left: 20px;
    }

    .nickname {
      font-weight: 700;
      font-size: 24px;
      margin: 0;
    }

    .level {
      font-size: 16px;
      margin: 4px 0 0;
    }

    .mission-section {
      margin-top: 30px;
    }

    .mission-title {
      font-weight: 700;
      font-size: 20px;
      margin: 0 0 8px;
    }

    .mission-progress-text {
      font-size: 16px;
      margin: 0 0 8px;
    }

    .progress-bar {
      width: 100%;
      background: #eee;
      height: 12px;
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 12px;
      background: #267C13;
      width: 0%;
      transition: width 0.3s ease;
    }

    .menu-buttons {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .menu-button {
      width: 100%;
      padding: 12px 0;
      border: 1px solid #000;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 700;
      text-align: center;
      background: white;
      cursor: pointer;
    }

    .personal-section {
      margin-top: 40px;
    }

    .personal-title {
      font-weight: 700;
      font-size: 20px;
      margin: 0 0 8px;
    }

    .email-text {
      font-size: 16px;
      margin: 0 0 12px;
    }

    .small-buttons-vertical {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
      margin-top: 12px;
    }

    .small-button {
      width: 180px;
      padding: 8px 0;
      font-size: 16px;
      border: 1px solid #000;
      border-radius: 8px;
      text-align: center;
      background: white;
      cursor: pointer;
    }

    .logout-withdraw {
      display: flex;
      justify-content: space-between;
      margin-top: 16px;
    }

    .logout-withdraw span {
      font-size: 16px;
      color: #000;
      cursor: pointer;
    }

    .bottom-nav {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 85px;
      background: rgba(113, 163, 4, 0.77);
      display: flex;
      justify-content: space-around;
      align-items: center;
      font-size: 14px;
      z-index: 10;
    }

    .bottom-nav div {
      text-align: center;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="main-wrapper">
    <div class="container">
      <div class="profile-section">
        <div class="profile-wrapper">
          <div class="profile-img">
            <!-- 기본 프로필 SVG -->
            <svg viewBox="0 0 140 135" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M108.996 107.421C114.648 102.299 119.151 96.1138 122.227 89.2474C125.302 82.381 126.884 74.9794 126.875 67.5C126.875 37.2094 101.413 12.6562 70 12.6562C38.5875 12.6562 13.125 37.2094 13.125 67.5C13.1161 74.9794 14.6981 82.381 17.7733 89.2474C20.8486 96.1138 25.3516 102.299 31.0042 107.421C41.5447 117.022 55.5004 122.363 70 122.344C84.4997 122.363 98.4554 117.022 108.996 107.421ZM35.8459 100.193C39.9413 95.2517 45.1384 91.2641 51.0512 88.5258C56.9641 85.7874 63.4406 84.3687 70 84.375C76.5594 84.3687 83.036 85.7874 88.9488 88.5258C94.8616 91.2641 100.059 95.2517 104.154 100.193C99.686 104.545 94.3662 107.998 88.5032 110.352C82.6403 112.706 76.3509 113.914 70 113.906C63.6491 113.914 57.3598 112.706 51.4969 110.352C45.6339 107.998 40.3141 104.545 35.8459 100.193ZM91.875 50.625C91.875 56.2194 89.5704 61.5847 85.468 65.5405C81.3656 69.4964 75.8016 71.7188 70 71.7188C64.1984 71.7188 58.6344 69.4964 54.5321 65.5405C50.4297 61.5847 48.125 56.2194 48.125 50.625C48.125 45.0306 50.4297 39.6653 54.5321 35.7095C58.6344 31.7536 64.1984 29.5313 70 29.5312C75.8016 29.5313 81.3656 31.7536 85.468 35.7095C89.5704 39.6653 91.875 45.0306 91.875 50.625Z"
                fill="#000" />
            </svg>
          </div>
          <img id="badge-overlay" class="badge-overlay" src="" alt="휘장">
        </div>

        <div class="nickname-box">
          <p class="nickname" id="nickname">닉네임</p>
          <p class="level" id="level">1단계</p>
        </div>
      </div>

      <div class="mission-section">
        <p class="mission-title">미션 수행 현황</p>
        <p class="mission-progress-text" id="mission-progress">미션 0 / 0개 완료</p>
        <div class="progress-bar">
          <div class="progress-bar-fill" id="progress-bar"></div>
        </div>
      </div>

      <div class="menu-buttons">
        <div class="menu-button" id="btn-dogam">도감</div>
        <div class="menu-button" id="btn-inventory">인벤토리</div>
        <div class="menu-button" id="btn-diary">내가 쓴 일기</div>
        <div class="menu-button" id="btn-scrap">스크랩한 글</div>
      </div>

      <div class="personal-section">
        <p class="personal-title">개인정보 수정</p>
        <p class="email-text" id="email">email@example.com</p>
        <div class="small-buttons-vertical">
          <div class="small-button" id="btn-email">이메일 변경</div>
          <div class="small-button" id="btn-password">비밀번호 변경</div>
        </div>
      </div>

      <div class="logout-withdraw">
        <span id="btn-logout">로그아웃</span>
        <span id="btn-withdraw">탈퇴</span>
      </div>
    </div>

    <div class="bottom-nav">
      <div onclick="location.href='/market'">🛖 그로우마켓</div>
      <div onclick="location.href='/home'">🏡 홈</div>
      <div onclick="location.href='/community'">👥 커뮤니티</div>
      <div onclick="location.href='/mypage'">👤 마이페이지</div>
    </div>
  </div>

  <script>
  fetch('/mypage/api')
    .then(res => res.json())
    .then(data => {
      console.log('[DEBUG] badgeType:', data.badgeType);

      document.getElementById('nickname').innerText = data.nickname + ' 님';
      document.getElementById('level').innerText = `${data.level}단계`;
      document.getElementById('mission-progress').innerText = `미션 ${data.missionStatus.completed} / ${data.missionStatus.total}개 완료`;
      const percent = (data.missionStatus.completed / data.missionStatus.total) * 100;
      document.getElementById('progress-bar').style.width = percent + '%';
      document.getElementById('email').innerText = data.email;

      const badge = document.getElementById('badge-overlay');
      if (data.badgeType === 'silver') {
        badge.src = '/images/badge/silver.png';
        badge.style.display = 'block';
      } else if (data.badgeType === 'gold') {
        badge.src = '/images/badge/gold.png';
        badge.style.display = 'block';
      } else {
        badge.style.display = 'none';
      }
    })
    .catch(err => console.error(err));

  // ✅ 메뉴 버튼들 이벤트 연결
  document.getElementById('btn-dogam').addEventListener('click', () => {
    window.location.href = '/collection?category=basic&page=1';
  });

  document.getElementById('btn-inventory').addEventListener('click', () => {
    window.location.href = '/inventory';  // 팀원이 구현할 인벤토리 페이지로 이동
  });

  document.getElementById('btn-diary').addEventListener('click', () => {
    window.location.href = '/diary';
  });

  document.getElementById('btn-scrap').addEventListener('click', () => {
    window.location.href = '/scrap';
  });
</script>

</body>
</html>
