<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë§ˆì´í˜ì´ì§€</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      background: #F9F9F9;
      display: flex;
      justify-content: center;
    }

    .main-wrapper {
      position: relative;
      width: 402px;
      height: 874px;
      background-color: #ffffff;
      overflow: hidden;
    }

    .container {
      padding: 20px;
      padding-bottom: 90px;
    }

    /* ğŸ… í”„ë¡œí•„ + íœ˜ì¥ */
    .profile-section {
      display: flex;
      align-items: center;
      margin-top: 20px;
    }

    .profile-wrapper {
      position: relative;
      width: 100px;
      height: 100px;
    }

    .profile-img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      overflow: hidden;
      z-index: 1;
    }

    .profile-img svg {
      width: 100px;
      height: 100px;
      display: block;
    }

    .badge-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100px;
      height: 100px;
      z-index: 2;
      pointer-events: none;
    }

    .nickname-box {
      margin-left: 20px;
    }

    .nickname {
      font-weight: 700;
      font-size: 24px;
      margin: 0;
    }

    .level {
      font-size: 16px;
      margin: 4px 0 0;
    }

    .mission-section {
      margin-top: 30px;
    }

    .mission-title {
      font-weight: 700;
      font-size: 20px;
      margin: 0 0 8px;
    }

    .mission-progress-text {
      font-size: 16px;
      margin: 0 0 8px;
    }

    .progress-bar {
      width: 100%;
      background: #eee;
      height: 12px;
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 12px;
      background: #267C13;
      width: 0%;
      transition: width 0.3s ease;
    }

    .menu-buttons {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .menu-button {
      width: 100%;
      padding: 12px 0;
      border: 1px solid #000;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 700;
      text-align: center;
      background: white;
      cursor: pointer;
    }

    .personal-section {
      margin-top: 40px;
    }

    .personal-title {
      font-weight: 700;
      font-size: 20px;
      margin: 0 0 8px;
    }

    .email-text {
      font-size: 16px;
      margin: 0 0 12px;
    }

    .small-buttons-vertical {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
      margin-top: 12px;
    }

    .small-button {
      width: 180px;
      padding: 8px 0;
      font-size: 16px;
      border: 1px solid #000;
      border-radius: 8px;
      text-align: center;
      background: white;
      cursor: pointer;
    }

    .logout-withdraw {
      display: flex;
      justify-content: space-between;
      margin-top: 16px;
    }

    .logout-withdraw span {
      font-size: 16px;
      color: #000;
      cursor: pointer;
    }

    .bottom-nav {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 85px;
      background: rgba(113, 163, 4, 0.77);
      display: flex;
      justify-content: space-around;
      align-items: center;
      font-size: 14px;
      z-index: 10;
    }

    .bottom-nav div {
      text-align: center;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="main-wrapper">
    <div class="container">
      <div class="profile-section">
        <div class="profile-wrapper">
          <div class="profile-img">
            <!-- ê¸°ë³¸ í”„ë¡œí•„ SVG -->
            <svg viewBox="0 0 140 135" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M108.996 107.421C114.648 102.299 119.151 96.1138 122.227 89.2474C125.302 82.381 126.884 74.9794 126.875 67.5C126.875 37.2094 101.413 12.6562 70 12.6562C38.5875 12.6562 13.125 37.2094 13.125 67.5C13.1161 74.9794 14.6981 82.381 17.7733 89.2474C20.8486 96.1138 25.3516 102.299 31.0042 107.421C41.5447 117.022 55.5004 122.363 70 122.344C84.4997 122.363 98.4554 117.022 108.996 107.421ZM35.8459 100.193C39.9413 95.2517 45.1384 91.2641 51.0512 88.5258C56.9641 85.7874 63.4406 84.3687 70 84.375C76.5594 84.3687 83.036 85.7874 88.9488 88.5258C94.8616 91.2641 100.059 95.2517 104.154 100.193C99.686 104.545 94.3662 107.998 88.5032 110.352C82.6403 112.706 76.3509 113.914 70 113.906C63.6491 113.914 57.3598 112.706 51.4969 110.352C45.6339 107.998 40.3141 104.545 35.8459 100.193ZM91.875 50.625C91.875 56.2194 89.5704 61.5847 85.468 65.5405C81.3656 69.4964 75.8016 71.7188 70 71.7188C64.1984 71.7188 58.6344 69.4964 54.5321 65.5405C50.4297 61.5847 48.125 56.2194 48.125 50.625C48.125 45.0306 50.4297 39.6653 54.5321 35.7095C58.6344 31.7536 64.1984 29.5313 70 29.5312C75.8016 29.5313 81.3656 31.7536 85.468 35.7095C89.5704 39.6653 91.875 45.0306 91.875 50.625Z"
                fill="#000" />
            </svg>
          </div>
          <img id="badge-overlay" class="badge-overlay" src="" alt="íœ˜ì¥">
        </div>

        <div class="nickname-box">
          <p class="nickname" id="nickname">ë‹‰ë„¤ì„</p>
          <p class="level" id="level">1ë‹¨ê³„</p>
        </div>
      </div>

      <div class="mission-section">
        <p class="mission-title">ë¯¸ì…˜ ìˆ˜í–‰ í˜„í™©</p>
        <p class="mission-progress-text" id="mission-progress">ë¯¸ì…˜ 0 / 0ê°œ ì™„ë£Œ</p>
        <div class="progress-bar">
          <div class="progress-bar-fill" id="progress-bar"></div>
        </div>
      </div>

      <div class="menu-buttons">
        <div class="menu-button" id="btn-dogam">ë„ê°</div>
        <div class="menu-button" id="btn-inventory">ì¸ë²¤í† ë¦¬</div>
        <div class="menu-button" id="btn-diary">ë‚´ê°€ ì“´ ì¼ê¸°</div>
        <div class="menu-button" id="btn-scrap">ìŠ¤í¬ë©í•œ ê¸€</div>
      </div>

      <div class="personal-section">
        <p class="personal-title">ê°œì¸ì •ë³´ ìˆ˜ì •</p>
        <p class="email-text" id="email">email@example.com</p>
        <div class="small-buttons-vertical">
          <div class="small-button" id="btn-email">ì´ë©”ì¼ ë³€ê²½</div>
          <div class="small-button" id="btn-password">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</div>
        </div>
      </div>

      <div class="logout-withdraw">
        <span id="btn-logout">ë¡œê·¸ì•„ì›ƒ</span>
        <span id="btn-withdraw">íƒˆí‡´</span>
      </div>
    </div>

    <div class="bottom-nav">
      <div onclick="location.href='/market'">ğŸ›– ê·¸ë¡œìš°ë§ˆì¼“</div>
      <div onclick="location.href='/home'">ğŸ¡ í™ˆ</div>
      <div onclick="location.href='/community'">ğŸ‘¥ ì»¤ë®¤ë‹ˆí‹°</div>
      <div onclick="location.href='/mypage'">ğŸ‘¤ ë§ˆì´í˜ì´ì§€</div>
    </div>
  </div>

  <script>
  fetch('/mypage/api')
    .then(res => res.json())
    .then(data => {
      console.log('[DEBUG] badgeType:', data.badgeType);

      document.getElementById('nickname').innerText = data.nickname + ' ë‹˜';
      document.getElementById('level').innerText = `${data.level}ë‹¨ê³„`;
      document.getElementById('mission-progress').innerText = `ë¯¸ì…˜ ${data.missionStatus.completed} / ${data.missionStatus.total}ê°œ ì™„ë£Œ`;
      const percent = (data.missionStatus.completed / data.missionStatus.total) * 100;
      document.getElementById('progress-bar').style.width = percent + '%';
      document.getElementById('email').innerText = data.email;

      const badge = document.getElementById('badge-overlay');
      if (data.badgeType === 'silver') {
        badge.src = '/images/badge/silver.png';
        badge.style.display = 'block';
      } else if (data.badgeType === 'gold') {
        badge.src = '/images/badge/gold.png';
        badge.style.display = 'block';
      } else {
        badge.style.display = 'none';
      }
    })
    .catch(err => console.error(err));

  // âœ… ë©”ë‰´ ë²„íŠ¼ë“¤ ì´ë²¤íŠ¸ ì—°ê²°
  document.getElementById('btn-dogam').addEventListener('click', () => {
    window.location.href = '/collection?category=basic&page=1';
  });

  document.getElementById('btn-inventory').addEventListener('click', () => {
    window.location.href = '/inventory';  // íŒ€ì›ì´ êµ¬í˜„í•  ì¸ë²¤í† ë¦¬ í˜ì´ì§€ë¡œ ì´ë™
  });

  document.getElementById('btn-diary').addEventListener('click', () => {
    window.location.href = '/diary';
  });

  document.getElementById('btn-scrap').addEventListener('click', () => {
    window.location.href = '/scrap';
  });
</script>

</body>
</html>
