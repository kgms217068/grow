<!DOCTYPE html>
<html>
<head>
  <title>미션 진행</title>
  <link rel="stylesheet" href="/css/style.css" />
  <style>
    .mission-container { margin: 30px; padding: 20px; border: 1px solid #ccc; border-radius: 10px; background: #f9fff3; }
    .bottom-nav {
      position: fixed;
      bottom: 0;
      width: 100%;
      height: 60px;
      background-color: #a4c639;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.2);
    }
    .bottom-nav a {
      text-align: center;
      color: #333;
      text-decoration: none;
      font-size: 14px;
    }
    .bottom-nav i {
      font-size: 20px;
      display: block;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

<div class="mission-container">
  <% if (mission) { %>
    <h2><%= mission.level %>단계 미션</h2>
    <p><strong><%= mission.description %></strong></p>

    <% if (result) { %>
      <p style="color: green;">✅ 완료한 미션입니다</p>
      <% if (result.photo) { %>
        <img src="/uploads/<%= result.photo %>" width="200" />
      <% } %>
      <% if (result.memo) { %>
        <p><strong>소감:</strong> <%= result.memo %></p>
      <% } %>
      <a href="/dashboard">다음 미션 보기</a>
    <% } else { %>
      <form action="/dashboard/submit" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="missionId" value="<%= mission.mission_id %>">

        <p><input type="file" name="photo" required></p>

        <label>
          <input type="checkbox" name="success" onchange="toggleMemo(this)"> 미션 성공했어요!
        </label>

        <div id="memo-box" style="display:none">
          <textarea name="memo" placeholder="소감 작성 (선택)" rows="3"></textarea>
        </div>

        <button type="submit">제출</button>
      </form>
    <% } %>

  <% } else { %>
    <h2>🎉 모든 미션을 완료했습니다!</h2>
  <% } %>
</div>

<!-- ✅ 하단 네비게이션바 -->
<div class="bottom-nav">
  <a href="/market"><i>🎁</i>그로우마켓</a>
  <a href="/dashboard"><i>🏠</i>홈</a>
  <a href="/community"><i>👥</i>커뮤니티</a>
  <a href="/mypage"><i>👤</i>마이페이지</a>
</div>

<script>
  function toggleMemo(checkbox) {
    const box = document.getElementById('memo-box');
    box.style.display = checkbox.checked ? 'block' : 'none';
  }
</script>

</body>
</html>
